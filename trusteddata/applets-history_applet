{"id":"history_applet","content":"{\"html\":\"\",\"js\":\"let A \u003d getUApi();\\nlet id \u003d A.getInput()[0];\\n\\nif(!id) {\\n   A.makeH3({innerText: \u0027No document id is input, put `!doc-id` in searchbox to input doc-id\u0027})\\n   return;\\n}\\n\\nA.makeSpan({innerHTML: `History of \u003cb\u003e\u003ca href\u003d\\\"/?q\u003d@${id}\\\"\u003e${id}\u003c/a\u003e\u003c/b\u003e`})\\n\\nget(`/versionsof/${id}`)\\n  .then(r \u003d\u003e JSON.parse(r.response))\\n  .then(dh \u003d\u003e {\\n     let ul \u003d A.makeUl();\\n     let content \u003d dh.edits.sort((a,b) \u003d\u003e b.mtime-a.mtime).forEach(edit \u003d\u003e {\\n\\n        let li \u003d A.makeLi({style: \u0027margin: 5px\u0027}, ul);\\n\\n        A.makeB({innerText: `On ${(new Date(edit.mtime).toLocaleDateString())} by ${edit.author}`, style: style\u003d\u0027font-size: 0.8em; display: block\u0027}, li)\\n        A.makeI({innerText: edit.changeNote, style: style\u003d\u0027display: block\u0027}, li)\\n        A.makeA({style: \u0027font-size: 0.8em; margin: 0px 3px\u0027, href: \\\"#\\\", innerText: \u0027view diff\u0027}, li)\\n          .addEventListener(\u0027click\u0027, function() { })\\n        A.makeA({style: \u0027font-size: 0.8em; margin: 0px 3px\u0027, href: \\\"#\\\", innerText: \u0027make current\u0027}, li)\\n          .addEventListener(\u0027click\u0027, function() { })\\n     })\\n  })\\n  .catch(e \u003d\u003e showError(e.message))\"}","type":"applets","tags":["inodesapp","history"],"owner":"admin","postTime":1617528628901,"visibility":["u-admin","g-security"],"savedVisibility":["u-admin","g-security"],"needsApproval":true}