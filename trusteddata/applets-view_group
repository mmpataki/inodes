{"id":"view_group","content":"{\"html\":\"\",\"js\":\"let A \u003d getUApi()\\nlet g \u003d A.getInput()[0]\\n\\nif(!g) {\\n  A.makeH3({innerText: \u0027No groupid is input, Paste `!groupid` to input group id\u0027})\\n  return\\n}\\n\\nlet tagStyle \u003d \u0027display: inline-block; padding: 2px 8px; background-color: #eaeaea; border: solid 1px gray; color: black; margin: 2px; border-radius: 3px; cursor: pointer;\u0027\\nlet grp;\\nlet gUsersDiv;\\nlet aUsersDiv;\\nlet addBtn;\\n\\nlet gName \u003d A.makeH3({ style: \\\"margin: 3px 0px\\\" })\\nlet gDesc \u003d A.makeSpan({})\\nlet gMail \u003d A.makeSpan({})\\nlet gTUrl \u003d A.makeSpan({})\\ngUsersDiv \u003d A.makeDiv({ style: \u0027display: block; padding:5px; border: solid 1px #f2f2f2; border-radius: 8px; margin-top: 5px\u0027 })\\nA.makeSpan({ innerText: \u0027All users\u0027, style: \u0027margin: 5px 0px; font-weight: bolder\u0027 })\\naUsersDiv \u003d A.makeDiv({ style: \u0027display: block; padding:5px; border: solid 1px #f2f2f2; border-radius: 8px; margin-top: 5px\u0027 })\\n\\nget(`/auth/groups/${g}`).then(x \u003d\u003e {\\n    grp \u003d JSON.parse(x.response)\\n    gName.innerText \u003d grp.groupName\\n    gDesc.innerHTML \u003d `\u003cb\u003edesc: \u003c/b\u003e${grp.desc}\u003cbr/\u003e`\\n    gMail.innerHTML \u003d `\u003cb\u003eemail: \u003c/b\u003e${grp.email}\u003cbr/\u003e`\\n    gTUrl.innerHTML \u003d `\u003cb\u003eteams url: \u003c/b\u003e${grp.teamsUrl}\u003cbr/\u003e`\\n    grp.users.forEach(user \u003d\u003e addToGList(user))\\n}).then(x \u003d\u003e {\\n    get(\u0027/auth/users\u0027).then(x \u003d\u003e {\\n        let users \u003d JSON.parse(x.response)\\n        users.forEach(user \u003d\u003e {\\n            addToAList(user)\\n        })\\n    })\\n})\\n\\nfunction addToGList(user) {\\n    if (addBtn) {\\n        addBtn.remove()\\n    }\\n    let uspan \u003d A.makeSpan({ innerText: user, style: tagStyle }, gUsersDiv)\\n    let urem \u003d A.makeSpan({ innerText: \u0027x\u0027, style: \u0027padding: 0px 3px; font-size: 0.8em; border-radius: 50%; background-color: black; color: white; margin-left: 5px\u0027 }, uspan)\\n    urem.addEventListener(\u0027click\u0027, function () {\\n        post(`/auth/groups/${g}/delete?user\u003d${user}`)\\n            .then(x \u003d\u003e showSuccess(`Removed ${user} from ${g}`))\\n            .then(x \u003d\u003e uspan.remove())\\n            .then(x \u003d\u003e grp.users.splice(grp.users.indexOf(user), 1))\\n            .then(x \u003d\u003e addToAList(user))\\n            .catch(x \u003d\u003e showError(x.message))\\n    })\\n    if (addBtn) {\\n        gUsersDiv.appendChild(addBtn)\\n    }\\n}\\n\\nlet all__userToSpan \u003d {}\\nfunction addToAList(user) {\\n    if(all__userToSpan[user]) {\\n        all__userToSpan[user].remove()\\n    }\\n    let uspan \u003d A.makeSpan({ style: tagStyle, innerText: user }, aUsersDiv);\\n    all__userToSpan[user] \u003d uspan;\\n    if (!grp.users.includes(user)) {\\n        let uadd \u003d A.makeSpan({ uid: user, style: \u0027padding: 0px 3px; font-size: 0.8em; border-radius: 50%; background-color: green; color: white; margin-left: 5px\u0027, innerHTML: \u0027+\u0027 }, uspan);\\n        uadd.addEventListener(\u0027click\u0027, function () {\\n            post(`/auth/groups/${g}/add?user\u003d${user}`)\\n                .then(x \u003d\u003e showSuccess(`Added ${user} to ${g}`))\\n                .then(x \u003d\u003e uadd.remove())\\n                .then(x \u003d\u003e grp.users.push(user))\\n                .then(x \u003d\u003e addToGList(user))\\n                .catch(x \u003d\u003e showError(x.message))\\n        })\\n    }\\n}\\n\"}","type":"applets","tags":["inodesapp","viewgroup"],"owner":"admin","postTime":1615107343674,"visibility":["u-admin","g-security"],"savedVisibility":["g-public"],"needsApproval":true}